<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-07-08 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20140708" />
    <meta http-equiv="Content-Language" content="en" />
    <title>npmpack-maven-plugin - Overview</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

                          
        
<link rel="shortcut icon" href="favicon-32.ico"/>
          
                  </head>
        <body class="topBarEnabled">
          
    
    
            
    
        
    <a href="http://github.com/pkozelka/npmpack-maven-plugin">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                        
                    
                

    <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
                                  <div class="container"><div class="nav-collapse">
            
                
                                            <a class="brand" href="http://pkozelka.github.io"  title="npmpack-maven-plugin">

                                
                                    NPMPACK
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Overview">Overview</a>
</li>
                  
                      <li>      <a href="plugin-info.html"  title="Goals">Goals</a>
</li>
                  
                      <li>      <a href="features.html"  title="Features">Features</a>
</li>
                  
                      <li class="dropdown-submenu">
                                      <a href="usage.html"  title="Usage">Usage</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="grunt.html"  title="Embedding grunt build">Embedding grunt build</a>
</li>
                                  <li>      <a href="tar.html"  title="Using TAR to compress data">Using TAR to compress data</a>
</li>
                                  <li>      <a href="best-practices.html"  title="Recommended configuration">Recommended configuration</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="usage.html"  title="TODO">TODO</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="publish-npm.html"  title="Goal 'deploy' to publish artifacts for sharing">Goal 'deploy' to publish artifacts for sharing</a>
</li>
                                  <li>      <a href="faster-unzip.html"  title="Using faster external unzip">Using faster external unzip</a>
</li>
                                  <li>      <a href="archetypes.html"  title="Using npmpack archetypes">Using npmpack archetypes</a>
</li>
                                  <li>      <a href="samples.html"  title="Sample projects">Sample projects</a>
</li>
                                  <li>      <a href="bower.html"  title="Bower">Bower</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Links <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="http://www.apache.org/"  title="Apache">Apache</a>
</li>
                  
                      <li>      <a href="http://maven.apache.org/"  title="Maven 2">Maven 2</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reports <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="dependencies.html"  title="Dependencies">Dependencies</a>
</li>
                                  <li>      <a href="team-list.html"  title="Project Team">Project Team</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Tracking">Issue Tracking</a>
</li>
                                  <li>      <a href="license.html"  title="Project License">Project License</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Repository">Source Repository</a>
</li>
                                  <li>      <a href="project-summary.html"  title="Project Summary">Project Summary</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="plugin-info.html"  title="Plugin Documentation">Plugin Documentation</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
          
                                                                            
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2></h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href=".." title="code">
        code</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="index.html" title="npmpack-maven-plugin">
        npmpack-maven-plugin</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Overview</li>
        
                
                    
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2014-07-08</li>
              <li id="projectVersion" class="pull-right">
                    Version: 1.0-SNAPSHOT
        </li>
            
                            </ul>
      </div>

      
                        
        <div id="bodyColumn" >
                                  
            <div class="section">
<h2>Overview<a name="Overview"></a></h2>
<p>NPMPACK maven plugin simplifies integration of UI build, performed by NodeJs/NPM based tools like Grunt, into Maven build.</p>
<p>It is designed to:</p>

<ul>
  
<li>connect the two worlds, Maven and NPM, without compromises and hard impact on workflow of any of them</li>
  
<li>reduce or prevent NPM to download bits from whole internet during regular project build, to remove significant source of build instability</li>
  
<li>store npm dependencies by Maven&#x2019;s mature repository and caching system</li>
</ul></div>
<div class="section">
<h2>The difference between Maven and Grunt build<a name="The_difference_between_Maven_and_Grunt_build"></a></h2>
<p><img src="npmpack-TypicalMavenBuild.png" alt="Typical Maven Build" /> <img src="npmpack-TypicalGruntBuild.png" alt="Typical Grunt Build" /></p>
<p>The important piece here is the <b>Nexus</b> server (or in general, Maven Repository Manager).</p>
<p>It acts as the caching proxy, which isolates build of the project from temporary outages. Cached artifacts are typically available on your local network.</p>
<p>Another important point is that Maven&#x2019;s local repository is <i>outside</i> the project source tree, and is therefore not frequently cleaned. </p>
<p>It introduces yet another level of caching, this time directly at the machine. </p>
<p>With <tt>grunt</tt>, which uses <tt>node</tt> and <tt>npm</tt> for preparing dependencies, there is no such component. Theoretically, a generic caching HTTP proxy can be involved to handle its role, and probably some already exists. TODO: explore this.</p>
<p>But here comes the other disadvantage of <tt>node</tt> approach: the local cache is (by default) in the <tt>node_modules</tt> directory, and is therefore subject to frequent cleanup. This makes the build frequently exposed to interaction with network, typically internet, and therefore very sensitive to various kinds of outages. Simply, less stable. </p></div>
<div class="section">
<h2>The integrated build<a name="The_integrated_build"></a></h2>
<p>The problematic part is that <tt>npm</tt> gathers dependencies in directory <tt>node_modules</tt> during every build.</p>
<p>To prevent this, the <tt>npmpack-maven-plugin</tt> takes complete care about this directory. That is:</p>

<ul>
  
<li>if it exists but is obsolete (because <tt>package.json</tt> has changed), deletes it</li>
  
<li>if it does not exist, downloads (or locates in local repo) <i>maven artifact</i> which contains it</li>
  
<li>if it cannot be downloaded, it normally fails the build <i>(regular build)</i></li>
  
<li>in <i>maintenance build</i>, it calls <tt>npm install</tt> and then packages the resulting <tt>node_modules</tt> as a maven artifact. Then the developer&#x2019;s should publish it into Nexus for sharing with the team.</li>
</ul>
<p>We assume that npm dependencies (expressed in the <tt>package.json</tt> file) do not change very often. Therefore, as noted above, we differentiate between two build types:</p>

<ul>
  
<li><b>regular</b> build, which is the one that your CI system is configured to always perform, and developer uses most of the time. NPM is <i>not</i> allowed to access internet; everything must come through Maven repositories.</li>
  
<li><b>maintenance</b> build, during which developer prepares Maven artifacts wrapping the changed npm dependencies. NPM of course uses internet to gather the packages.</li>
</ul>
<div class="section">
<h3>Regular build<a name="Regular_build"></a></h3>
<p>This is the everyday build, intended for use in Jenkins and most developer usecases. To enforce it, add <tt>-Dnpmpack.allowNpmInstall=false</tt> to Maven commandline - but it is a default, unless your POMs define otherwise.</p></div>
<div class="section">
<h3>Maintenance build<a name="Maintenance_build"></a></h3>
<p>During this build, we allow NPM to install components, or different versions, from internet. This gives the developer an opportunity to take care with any issues that NPM may have. To use it, add <tt>-Dnpmpack.allowNpmInstall</tt> to your Maven Commandline.</p>
<p>In this case, the plugin does not fail when <tt>package.json</tt> is changed; instead, it invokes <tt>npm install</tt> and generates new package. The developer should upload this new package into a Nexus (or other Maven Repository Manager) so that CI and other developers can use it.</p>
<p>Note that the generated artifact comes together with generated pom file, to avoid any mistakes during upload.</p></div></div>
                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
                      <div class="row">
                              <p >Copyright &copy;                    2014
                        <a href="https://pkozelka.github.io">Petr Kozelka</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
                <p id="poweredBy" class="pull-right">
                                                                                                                <a href="http://maven.apache.org" title="Apache Maven" class="builtBy">
        <img class="builtBy"  alt="Apache Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    />
      </a>
                  </p>
        
                </div>
    </footer>
        </body>
</html>
